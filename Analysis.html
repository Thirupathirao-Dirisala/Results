<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bapatla Engineering College</title>
    <link
            rel="stylesheet"
            href="https://pyscript.net/latest/pyscript.css"/>
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <style>
  #main{
    margin-top:30px;
    margin-bottom:30px;
    margin-left:100px;
    background-color:white;
    margin-right:100px;
    border:1px black solid;
    border-radius:5px;
  }
  body{
    background-color:#91E0FF;
  }
  th{
    background-color:#00ABF0;
    text-align:center;
    color:white;
    width:40%;
    height:50%;
    font-weight: bold;
    }
    td{
        text-align:center;
        background-color:#91E0FF;
    }
    table{
       border-radius:5px;
        border:3px black;
        width:80%;
        border-collapse:collapse;
    }
</style>

</head>
<body>
    <marquee direction="right" behavior="alternate" style="color:red;font-weight:bold;">***If Same Marks are scored by two students then the rank will be considered based on name***</marquee>
    <div id="main" align="center">
        <img src="https://raw.githubusercontent.com/Thirupathirao-Dirisala/Results/main/bec2.jpeg" border="1" width="1045px" style="border-radius:5px" height="350px"/>
        <div id="details">
         <table style="border:3px black;border-radius:5px;width:80%;border-collapse:separate">
            <tr>
                <th>Regd.No.</th>
                <td id="regdno"></td>
                <td rowspan="3"> <img id="imag" border="2"  width="220px" height="220px" alt="Photo"/></td>
            </tr>
            <tr>
                <th>Full Name</th>
                <td id="name"></td>
            </tr>
            <tr>
                <th>Father Name</th>
                <td id="fname"></td>
            </tr>
        </table>
        </div>
        <div id="sem1">
            <h5 id="s1"></h5>
        </div>
        <div id="sem2">
            <h5 id="s2"></h5>
        </div>
        <div id="sem3">
            <h5 id="s3"></h5>
        </div>
        <div id="sem4">
            <h5 id="s4"></h5>
        </div>
        <div id="sem5">
            <h5 id="s5"></h5>
        </div>
    </div>
    <py-config>
        packages = ["pandas","matplotlib"]
    </py-config>
    <py-script>
        try:
            n=[1,4]
            import pandas as pd
            import js
            from js import document
            import matplotlib.pyplot as plt
            from pyodide.http import open_url
            k=js.localStorage.getItem('myValue')
            r=k.lower()
            ele=document.getElementById("imag")
            ele.setAttribute("src",f"https://raw.githubusercontent.com/Thirupathirao-Dirisala/Results/main/{r}.jpg")
            for i in n:
                url = f"https://raw.githubusercontent.com/Thirupathirao-Dirisala/Results/main/IT-4.{i}.csv"
                df = pd.read_csv(open_url(url))
                x=df.loc[df["Reg No"] == r]
                cols=x.columns.tolist()
                subjects=cols[7:14]
                marks=x.values.tolist()[0]
                document.getElementById("regdno").innerHTML=marks[0].upper()
                document.getElementById("name").innerHTML=marks[1]
                document.getElementById("fname").innerHTML=marks[2]
                rank_m=marks[4]
                rank_s=marks[6]
                sgpa=marks[5]
                total1=marks[3]
                sub_marks=marks[7:14]
                topper= df[df['total'] == df['total'].max()]
                topper_m=topper.values.tolist()[0]
                total2=topper_m[2]
                topper_m=topper_m[7:14]
                p=pd.DataFrame({r:sub_marks,"1st ranker":topper_m},index=subjects)
                ax=p.plot.bar()
                plt.yticks(range(0,160,20))
                plt.xticks(rotation=360)
                ax.set_facecolor("#e0e0e0")
                for p in ax.patches:
                    ax.annotate(f'{p.get_height()}', (p.get_x() + p.get_width() / 2., p.get_height()), ha='center', va='bottom', fontsize=10, color='black', xytext=(0, 5), textcoords='offset points')
                subj=marks[-7:-1]
                subj.append(marks[-1])
                subj_rank=marks[-14:-6]
                tabl=pd.DataFrame(list(zip(subj,sub_marks,subj_rank)),columns=['Subject Title & Code','Marks','Subject Rank'])
                html_table=tabl.to_html(index=False)
                display(f"Semester:{i}",target=f"s{i}")
                display(HTML(html_table),target=f"sem{i}")
                display(plt,target=f"sem{i}")
                plt.clf()
                html_table=""
        except:
            from js import window
            window.location.href="Error.html"

</py-script>



</body>
</html>
